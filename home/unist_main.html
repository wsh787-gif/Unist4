<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UNIST ë°˜ë„ì²´ AI ìµœê³ ìœ„ê³¼ì • ì›ìš°ìˆ˜ì²©</title>
    <link rel="stylesheet" href="members.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>UNIST ë°˜ë„ì²´ AI ìµœê³ ìœ„ê³¼ì • ì›ìš°ìˆ˜ì²©</h1>
            <div class="header-stats">
                <div class="stat-item">
                    <input type="file" id="fileInput" accept=".json">
                </div>
                <div class="stat-item">
                    ì´ <span id="totalCount">0</span>ëª…
                </div>
                <div class="stat-item">
                    <span id="filteredCount">0</span>ê°œ ê²°ê³¼
                </div>
            </div>
        </header>

        <aside class="sidebar">
            <div class="sidebar-content">
                <div class="section">
                    <div class="section-title">ğŸ” ê²€ìƒ‰</div>
                    <input type="text" id="searchInput" class="search-input" placeholder="ì´ë¦„, íšŒì‚¬ëª… ê²€ìƒ‰">
                    <div id="activeFilters" class="active-filters"></div>
                </div>

                <div class="section">
                    <div class="section-title">ğŸ›ï¸ í•„í„°</div>
                    <div class="filters-compact">
                        <div class="filter-group">
                            <label class="filter-label">ê¸°ìˆ˜</label>
                            <select id="courseFilter" class="filter-select">
                                <option value="">ì „ì²´</option>
                                <option value="4ê¸°">4ê¸°</option>
                                <option value="êµìˆ˜ì§„">êµìˆ˜ì§„</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label class="filter-label">ì§€ì—­</label>
                            <select id="regionFilter" class="filter-select">
                                <option value="">ì „ì²´</option>
                                <option value="ê²½ê¸°ë„">ê²½ê¸°ë„</option>
                                <option value="ì¸ì²œ">ì¸ì²œ</option>
                                <option value="ê²½ìƒë¶ë„">ê²½ìƒë¶ë„</option>
                                <option value="í‰íƒì‹œ">í‰íƒì‹œ</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label class="filter-label">ì—…ì¢…</label>
                            <select id="industryFilter" class="filter-select">
                                <option value="">ì „ì²´</option>
                                <option value="ë°˜ë„ì²´">ë°˜ë„ì²´</option>
                                <option value="í™”í•™ì•½í’ˆ">í™”í•™ì•½í’ˆ</option>
                                <option value="êµìœ¡">êµìœ¡</option>
                            </select>
                        </div>
                    </div>
                    <button id="clearFilters" class="btn btn-secondary clear-btn">í•„í„° ì´ˆê¸°í™”</button>
                </div>

                <div class="section">
                    <div class="section-title">âš™ï¸ ê´€ë¦¬</div>
                    <button id="addMemberBtn" class="btn btn-success">+ ì›ìš° ì¶”ê°€</button>
                    <button id="editMemberBtn" class="btn btn-primary">ì •ë³´ ìˆ˜ì •</button>
                    <a href="unist_member.html">
                    <button class="btn btn-success">+ ì›ìš° ê´€ë¦¬</button>
                    </a>
                </div>
            </div>
        </aside>

        <main class="main">
            <div class="content-header">
                <div class="view-toggle">
                    <button class="view-btn active" id="cardViewBtn">ì¹´ë“œ</button>
                    <button class="view-btn" id="listViewBtn">ëª©ë¡</button>
                </div>
                <div class="navigation">
                    <button class="nav-btn" id="prevBtn" type="button">â€¹</button>
                    <div class="page-info">
                        <span id="currentPage">1</span> / <span id="totalPages">13</span>
                    </div>
                    <button class="nav-btn" id="nextBtn" type="button">â€º</button>
                </div>
            </div>

            <div class="content" id="content">
                <!-- ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>
        </main>
    </div>

    <!-- ëª¨ë‹¬ -->
    <div id="addModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">ì›ìš° ì¶”ê°€</h2>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="memberForm">
                    <div class="photo-upload-section">
                        <div class="photo-preview" id="photoPreview" onclick="clickPhotoUpload()">
                            <div class="photo-preview-text">ğŸ“·</div>
                        </div>
                        <div style="margin-top: 12px;">
                            <input type="file" id="photoInput" accept="image/*" onchange="onPhotoSelected(this)">
                            <button type="button" class="photo-remove-btn" onclick="clearPhoto()">ğŸ—‘ï¸ ì‚¬ì§„ ì œê±°</button>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">ê¸°ìˆ˜ *</label>
                        <select id="memberCourse" class="form-select" required>
                            <option value="">ì„ íƒ</option>
                            <option value="4ê¸°">4ê¸°</option>
                            <option value="êµìˆ˜ì§„">êµìˆ˜ì§„</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">ì´ë¦„ *</label>
                            <input type="text" id="memberName" class="form-input" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">ì˜ë¬¸ëª…</label>
                            <input type="text" id="memberNameEn" class="form-input">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">íšŒì‚¬ *</label>
                            <input type="text" id="memberCompany" class="form-input" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">ì§ìœ„</label>
                                <input type="text" id="memberTitle" class="form-input">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">ì „í™”</label>
                            <input type="tel" id="memberMobile" class="form-input">
                        </div>
                        <div class="form-group">
                            <label class="form-label">ì´ë©”ì¼</label>
                            <input type="email" id="memberEmail" class="form-input">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ì£¼ì†Œ</label>
                        <input type="text" id="memberAddress" class="form-input">
                    </div>
                    <div class="form-group">
                        <label class="form-label">ì›¹ì‚¬ì´íŠ¸</label>
                        <input type="url" id="memberWebsite" class="form-input">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal()">ì·¨ì†Œ</button>
                <button class="btn btn-primary" onclick="saveMember()">ì €ì¥</button>
            </div>
        </div>
    </div>



    <div id="toast" class="toast"></div>

    <script>
     let members = [];
    let filteredMembers = [];
    let currentIndex = 0;
    let currentView = 'card';
    let editingMember = null;
    let currentPhoto = null;

<!--    document.addEventListener('DOMContentLoaded', async function() {-->
<!--        await loadMembers();-->
<!--        setupEventListeners();-->
<!--        updateDisplay();-->
<!--        displayContent();-->
<!--    });-->

    document.addEventListener('DOMContentLoaded', function() {
        setupEventListeners();
    });


    // ğŸ”¹ members.json ë¶ˆëŸ¬ì˜¤ê¸°
    async function loadMembers() {
        try {
            const response = await fetch('members.json');
            if (!response.ok) throw new Error('JSON íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.');
            members = await response.json();
            filteredMembers = [...members];
            console.log("âœ… members.json ë¶ˆëŸ¬ì˜¤ê¸° ì„±ê³µ:", members);
        } catch (error) {
            console.error("âŒ members.json ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨:", error);
            members = [];
            filteredMembers = [];
        }
    }

    // ğŸ”¹ íŒŒì¼ ì„ íƒ ì´ë²¤íŠ¸
    document.getElementById('fileInput').addEventListener('change', function(event) {
        const file = event.target.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = function(e) {
            try {
                members = JSON.parse(e.target.result);
                filteredMembers = [...members];
                currentIndex = 0;
                console.log("âœ… íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸° ì„±ê³µ:", members);
                updateDisplay();
                displayContent();
            } catch (err) {
                console.error("âŒ JSON íŒŒì‹± ì‹¤íŒ¨:", err);
                alert("ì˜ëª»ëœ JSON íŒŒì¼ì…ë‹ˆë‹¤.");
            }
        };
        reader.readAsText(file);
    });

        function setupEventListeners() {
            document.getElementById('searchInput').addEventListener('input', filterMembers);
            document.getElementById('courseFilter').addEventListener('change', filterMembers);
            document.getElementById('regionFilter').addEventListener('change', filterMembers);
            document.getElementById('industryFilter').addEventListener('change', filterMembers);
            document.getElementById('clearFilters').addEventListener('click', clearFilters);

            document.getElementById('cardViewBtn').addEventListener('click', () => setView('card'));
            document.getElementById('listViewBtn').addEventListener('click', () => setView('list'));

            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');

            prevBtn.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                prevMember();
            });

            nextBtn.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                nextMember();
            });

            document.addEventListener('keydown', function(e) {
                if (currentView === 'card') {
                    if (e.key === 'ArrowLeft') {
                        e.preventDefault();
                        prevMember();
                    } else if (e.key === 'ArrowRight') {
                        e.preventDefault();
                        nextMember();
                    }
                }
            });

            document.getElementById('addMemberBtn').addEventListener('click', openModal);
            document.getElementById('editMemberBtn').addEventListener('click', editMember);
        }

        function clickPhotoUpload() {
            console.log('ğŸ“· ì‚¬ì§„ ë¯¸ë¦¬ë³´ê¸° í´ë¦­ë¨');
            const input = document.getElementById('photoInput');
            if (input) {
                input.click();
                console.log('íŒŒì¼ ì…ë ¥ í´ë¦­ ì‹¤í–‰');
            }
        }

        function onPhotoSelected(input) {
            console.log('ğŸ“± íŒŒì¼ ì„ íƒë¨:', input.files);

            if (!input.files || !input.files[0]) {
                console.log('ì„ íƒëœ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤');
                return;
            }

            const file = input.files[0];
            console.log('íŒŒì¼ ì •ë³´:', {
                name: file.name,
                size: (file.size / 1024 / 1024).toFixed(2) + 'MB',
                type: file.type
            });

            if (!file.type.startsWith('image/')) {
                alert('ì´ë¯¸ì§€ íŒŒì¼ë§Œ ì„ íƒí•´ì£¼ì„¸ìš”.');
                input.value = '';
                return;
            }

            if (file.size > 10 * 1024 * 1024) {
                alert('íŒŒì¼ í¬ê¸°ëŠ” 10MB ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.');
                input.value = '';
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                console.log('âœ… íŒŒì¼ ì½ê¸° ì„±ê³µ');
                currentPhoto = e.target.result;
                updatePhotoPreview();
                showToast(`${file.name} ì—…ë¡œë“œ ì™„ë£Œ!`, 'success');
            };

            reader.onerror = function() {
                console.error('âŒ íŒŒì¼ ì½ê¸° ì‹¤íŒ¨');
                alert('íŒŒì¼ì„ ì½ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            };

            reader.readAsDataURL(file);
        }

        function clearPhoto() {
            console.log('ğŸ—‘ï¸ ì‚¬ì§„ ì œê±°');
            currentPhoto = null;
            updatePhotoPreview();

            const input = document.getElementById('photoInput');
            if (input) {
                input.value = '';
            }

            showToast('ì‚¬ì§„ì´ ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤.', 'warning');
        }

        function updatePhotoPreview() {
            const preview = document.getElementById('photoPreview');
            if (!preview) return;

            if (currentPhoto) {
                console.log('ğŸ–¼ï¸ ì‚¬ì§„ ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸');
                preview.innerHTML = `<img src="${currentPhoto}" alt="ì„ íƒëœ ì‚¬ì§„">`;
            } else {
                preview.innerHTML = '<div class="photo-preview-text">ğŸ“·</div>';
            }
        }

        function filterMembers() {
            const search = document.getElementById('searchInput').value.toLowerCase();
            const course = document.getElementById('courseFilter').value;
            const region = document.getElementById('regionFilter').value;
            const industry = document.getElementById('industryFilter').value;

            filteredMembers = members.filter(member => {
                const matchSearch = member.name.toLowerCase().includes(search) ||
                                   member.company.toLowerCase().includes(search) ||
                                   member.role.toLowerCase().includes(search);
                const matchCourse = !course || member.course === course;
                const matchRegion = !region || member.address.includes(region);
                const matchIndustry = !industry || member.industry === industry;

                return matchSearch && matchCourse && matchRegion && matchIndustry;
            });

            updateActiveFilters();
            currentIndex = 0;
            updateDisplay();
            displayContent();
        }

        function updateActiveFilters() {
            const container = document.getElementById('activeFilters');
            container.innerHTML = '';

            const filters = [
                {id: 'courseFilter', label: 'ê¸°ìˆ˜'},
                {id: 'regionFilter', label: 'ì§€ì—­'},
                {id: 'industryFilter', label: 'ì—…ì¢…'}
            ];

            filters.forEach(filter => {
                const value = document.getElementById(filter.id).value;
                if (value) {
                    const tag = document.createElement('div');
                    tag.className = 'filter-tag';
                    tag.innerHTML = `${filter.label}: ${value} <button class="filter-remove" onclick="removeFilter('${filter.id}')">Ã—</button>`;
                    container.appendChild(tag);
                }
            });
        }

        function removeFilter(filterId) {
            document.getElementById(filterId).value = '';
            filterMembers();
        }

        function clearFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('courseFilter').value = '';
            document.getElementById('regionFilter').value = '';
            document.getElementById('industryFilter').value = '';
            filterMembers();
        }

        function setView(view) {
            currentView = view;
            document.getElementById('cardViewBtn').classList.toggle('active', view === 'card');
            document.getElementById('listViewBtn').classList.toggle('active', view === 'list');
            updateDisplay();
            displayContent();
        }

        function updateDisplay() {
            document.getElementById('totalCount').textContent = members.length;
            document.getElementById('filteredCount').textContent = filteredMembers.length;
            document.getElementById('totalPages').textContent = Math.max(1, filteredMembers.length);
            document.getElementById('currentPage').textContent = filteredMembers.length > 0 ? currentIndex + 1 : 0;

            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');

            if (currentView === 'card') {
                prevBtn.style.display = 'flex';
                nextBtn.style.display = 'flex';

                if (currentIndex >= filteredMembers.length) {
                    currentIndex = Math.max(0, filteredMembers.length - 1);
                }

                if (currentIndex <= 0 || filteredMembers.length <= 1) {
                    prevBtn.disabled = true;
                    prevBtn.style.opacity = '0.5';
                } else {
                    prevBtn.disabled = false;
                    prevBtn.style.opacity = '1';
                }

                if (currentIndex >= filteredMembers.length - 1 || filteredMembers.length <= 1) {
                    nextBtn.disabled = true;
                    nextBtn.style.opacity = '0.5';
                } else {
                    nextBtn.disabled = false;
                    nextBtn.style.opacity = '1';
                }
            } else {
                prevBtn.style.display = 'none';
                nextBtn.style.display = 'none';
            }
        }

        function displayContent() {
            const content = document.getElementById('content');

            if (filteredMembers.length === 0) {
                content.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">ğŸ”</div>
                        <div>ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤</div>
                    </div>
                `;
                return;
            }

            if (currentView === 'card') {
                displayCard();
            } else {
                displayList();
            }
        }

        function displayCard() {
            const member = filteredMembers[currentIndex];
            const content = document.getElementById('content');

            content.innerHTML = `
                <div class="member-card">
                    <div class="card-header">
                        <div class="member-photo" onclick="editPhoto()">
                            ${member.photo ?
                                `<img src="${member.photo}" alt="${member.name}">` :
                                member.name.charAt(0)
                            }
                            <div class="photo-upload-overlay">
                                ğŸ“·<br>ì‚¬ì§„ ìˆ˜ì •
                            </div>
                        </div>
                        <div class="member-name">${member.name}</div>
                        <div class="member-name-en">${member.nameEn || ''}</div>
                        ${member.role ? `<div class="member-role">${member.role}</div>` : ''}
                    </div>
                    <div class="card-body">
                        <div class="info-grid">
                            <div class="info-section">
                                <div class="info-title">ê°œì¸ì •ë³´</div>
                                <div class="info-item">
                                    <span class="info-label">ê¸°ìˆ˜</span>
                                    <span class="info-value">${member.course}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">ì „í™”</span>
                                    <span class="info-value">${member.mobile || '-'}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">ì´ë©”ì¼</span>
                                    <span class="info-value">
                                        ${member.email ? `<a href="mailto:${member.email}" class="contact-link">${member.email}</a>` : '-'}
                                    </span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">ì£¼ì†Œ</span>
                                    <span class="info-value">${member.address || '-'}</span>
                                </div>
                            </div>
                            <div class="info-section">
                                <div class="info-title">íšŒì‚¬ì •ë³´</div>
                                <div class="info-item">
                                    <span class="info-label">íšŒì‚¬</span>
                                    <span class="info-value">${member.company}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">ì§ìœ„</span>
                                    <span class="info-value">${member.title || '-'}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">ë¶€ì„œ</span>
                                    <span class="info-value">${member.department || '-'}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">ì—…ì¢…</span>
                                    <span class="info-value">${member.industry}</span>
                                </div>
                                ${member.website ? `
                                <div class="info-item">
                                    <span class="info-label">ì›¹ì‚¬ì´íŠ¸</span>
                                    <span class="info-value">
                                        <a href="${member.website}" target="_blank" class="website-link">${member.website}</a>
                                    </span>
                                </div>` : ''}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function displayList() {
            const content = document.getElementById('content');
            content.innerHTML = `
                <div class="member-list">
                    ${filteredMembers.map((member, index) => `
                        <div class="list-item" onclick="selectMember(${index})">
                            <div class="list-photo">
                                ${member.photo ?
                                    `<img src="${member.photo}" alt="${member.name}">` :
                                    member.name.charAt(0)
                                }
                            </div>
                            <div class="list-info">
                                <div class="list-name">${member.name} (${member.role})</div>
                                <div class="list-company">${member.company} ${member.title ? `â€¢ ${member.title}` : ''}</div>
                                <div class="list-meta">${member.course} â€¢ ${member.industry} â€¢ ${member.mobile || 'ì—°ë½ì²˜ ì—†ìŒ'}</div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function selectMember(index) {
            currentIndex = index;
            setView('card');
        }

        function nextMember() {
            console.log('ë‹¤ìŒ ë²„íŠ¼ í´ë¦­ë¨', currentIndex, 'of', filteredMembers.length);
            if (filteredMembers.length > 1 && currentIndex < filteredMembers.length - 1) {
                currentIndex++;
                console.log('ìƒˆ ì¸ë±ìŠ¤:', currentIndex);
                updateDisplay();
                displayCard();
                showToast(`${filteredMembers[currentIndex].name} (${currentIndex + 1}/${filteredMembers.length})`, 'success');
            }
        }

        function prevMember() {
            console.log('ì´ì „ ë²„íŠ¼ í´ë¦­ë¨', currentIndex);
            if (filteredMembers.length > 1 && currentIndex > 0) {
                currentIndex--;
                console.log('ìƒˆ ì¸ë±ìŠ¤:', currentIndex);
                updateDisplay();
                displayCard();
                showToast(`${filteredMembers[currentIndex].name} (${currentIndex + 1}/${filteredMembers.length})`, 'success');
            }
        }

        function openModal() {
            editingMember = null;
            document.querySelector('.modal-title').textContent = 'ì›ìš° ì¶”ê°€';
            clearForm();

            const formGroups = document.querySelectorAll('.form-group, .form-row');
            formGroups.forEach(group => group.style.display = 'block');
            document.querySelector('.photo-upload-section').style.display = 'block';

            showModal();
        }

        function editMember() {
            if (filteredMembers.length === 0) {
                showToast('ìˆ˜ì •í•  íšŒì›ì´ ì—†ìŠµë‹ˆë‹¤.', 'error');
                return;
            }

            editingMember = filteredMembers[currentIndex];
            console.log('ìˆ˜ì •í•  íšŒì›:', editingMember);
            document.querySelector('.modal-title').textContent = 'ì •ë³´ ìˆ˜ì •';
            fillForm(editingMember);

            const formGroups = document.querySelectorAll('.form-group, .form-row');
            formGroups.forEach(group => group.style.display = 'block');
            document.querySelector('.photo-upload-section').style.display = 'block';

            showModal();
        }

        function editPhoto() {
            if (filteredMembers.length === 0) return;

            editingMember = filteredMembers[currentIndex];
            document.querySelector('.modal-title').textContent = 'ì‚¬ì§„ ìˆ˜ì •';
            fillForm(editingMember);

            const formGroups = document.querySelectorAll('.form-group, .form-row');
            formGroups.forEach(group => group.style.display = 'none');
            document.querySelector('.photo-upload-section').style.display = 'block';

            showModal();
        }

        function showModal() {
            const modal = document.getElementById('addModal');
            modal.classList.add('show');
        }

        function closeModal() {
            document.getElementById('addModal').classList.remove('show');
            editingMember = null;
        }

        function clearForm() {
            document.getElementById('memberCourse').value = '';
            document.getElementById('memberName').value = '';
            document.getElementById('memberNameEn').value = '';
            document.getElementById('memberCompany').value = '';
            document.getElementById('memberTitle').value = '';
            document.getElementById('memberMobile').value = '';
            document.getElementById('memberEmail').value = '';
            document.getElementById('memberAddress').value = '';
            document.getElementById('memberWebsite').value = '';

            currentPhoto = null;
            updatePhotoPreview();
            const photoInput = document.getElementById('photoInput');
            if (photoInput) {
                photoInput.value = '';
            }
        }

        function fillForm(member) {
            console.log('í¼ ì±„ìš°ê¸°:', member);
            document.getElementById('memberCourse').value = member.course || '';
            document.getElementById('memberName').value = member.name || '';
            document.getElementById('memberNameEn').value = member.nameEn || '';
            document.getElementById('memberCompany').value = member.company || '';
            document.getElementById('memberTitle').value = member.title || '';
            document.getElementById('memberMobile').value = member.mobile || '';
            document.getElementById('memberEmail').value = member.email || '';
            document.getElementById('memberAddress').value = member.address || '';
            document.getElementById('memberWebsite').value = member.website || '';

            currentPhoto = member.photo || null;
            updatePhotoPreview();
        }

        function saveMember() {
            const course = document.getElementById('memberCourse').value.trim();
            const name = document.getElementById('memberName').value.trim();
            const company = document.getElementById('memberCompany').value.trim();

            if (!course || !name || !company) {
                showToast('í•„ìˆ˜ í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error');
                return;
            }

            // Base64ë¡œ ë³€í™˜ëœ currentPhotoë¥¼ ê·¸ëŒ€ë¡œ ì €ì¥
            const memberData = {
                course: course,
                name: name,
                nameEn: document.getElementById('memberNameEn').value.trim(),
                company: company,
                title: document.getElementById('memberTitle').value.trim(),
                mobile: document.getElementById('memberMobile').value.trim(),
                email: document.getElementById('memberEmail').value.trim(),
                address: document.getElementById('memberAddress').value.trim(),
                website: document.getElementById('memberWebsite').value.trim(),
                industry: getIndustry(company),
                role: document.getElementById('memberTitle').value.trim() || 'íšŒì›',
                photo: currentPhoto || null  // ì—¬ê¸°ì„œ Base64ê°€ ì €ì¥ë©ë‹ˆë‹¤
            };

            if (editingMember && editingMember.id) {
                // ìˆ˜ì • ëª¨ë“œ
                const index = members.findIndex(m => m.id === editingMember.id);
                if (index !== -1) {
                    members[index] = { ...members[index], ...memberData };
                    showToast(`${memberData.name} ì •ë³´ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.`);
                } else {
                    showToast('íšŒì›ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
                    return;
                }
            } else {
                // ìƒˆ íšŒì› ì¶”ê°€ ëª¨ë“œ
                const newId = members.length ? Math.max(...members.map(m => m.id)) + 1 : 1;
                const newMember = { id: newId, products: [], interests: [], department: '', ...memberData };
                members.push(newMember);
                showToast(`${memberData.name} ì›ìš°ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.`);
            }

            // í™”ë©´ ê°±ì‹  ë° ëª¨ë‹¬ ë‹«ê¸°
            filterMembers();
            closeModal();

            // í¸ì§‘ìš© ì´ˆê¸°í™”
            editingMember = null;
            currentPhoto = null;
            const photoInput = document.getElementById('photoInput');
            if (photoInput) photoInput.value = '';
            const photoPreview = document.getElementById('photoPreview');
            if (photoPreview) photoPreview.innerHTML = '<div class="photo-preview-text">ğŸ“·</div>';
        }
        function getIndustry(company) {
            const companyLower = company.toLowerCase();
            if (companyLower.includes('smv') || companyLower.includes('juno') || companyLower.includes('tel') ||
                companyLower.includes('screen') || companyLower.includes('smart') || companyLower.includes('ë™ì§„') ||
                companyLower.includes('enf') || companyLower.includes('ì‹ ì„±') || companyLower.includes('ì›ìµ')) return 'ë°˜ë„ì²´';
            if (companyLower.includes('yc') || companyLower.includes('í™”í•™')) return 'í™”í•™ì•½í’ˆ';
            if (companyLower.includes('unist') || companyLower.includes('êµìˆ˜') || companyLower.includes('ì„ ìƒ')) return 'êµìœ¡';
            return 'ë°˜ë„ì²´';
        }

        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast ${type}`;
            toast.classList.add('show');

            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        document.getElementById('addModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });

        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeModal();
            }
        });
    </script>
</body>
</html>